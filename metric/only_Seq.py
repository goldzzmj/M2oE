import matplotlib.pyplot as plt


dict1 = {0: 0.03062315657734871, 1: 0.008696318604052067, 2: 0.004872379824519157,
         3: 0.004241651389747858, 4: 0.0038523655384778976, 6: 0.003838382661342621,
         7: 0.003372275736182928, 8: 0.003160733263939619, 10: 0.0030795754864811897,
         11: 0.0030091670341789722, 14: 0.002933523617684841, 15: 0.0028581153601408005,
         16: 0.002837871666997671, 18: 0.002778642112389207, 19: 0.0027196346782147884,
         21: 0.0026693115942180157, 23: 0.0026218786370009184, 26: 0.002607767004519701,
         27: 0.0025139297358691692, 28: 0.0024852000642567873, 29: 0.0024796598590910435,
         30: 0.002475184155628085, 31: 0.0024612064007669687, 32: 0.0024431049823760986,
         34: 0.002437807386741042, 36: 0.002415744122117758, 37: 0.002385933417826891,
         41: 0.002358740195631981, 44: 0.0023253033868968487, 45: 0.002309099305421114,
         47: 0.0022998028434813023, 54: 0.002231673337519169, 64: 0.0022127008996903896,
         65: 0.002192368032410741, 68: 0.0021915105171501637, 85: 0.0021850343327969313}


# dict2 = {0: 0.051314711570739746, 1: 0.031724561005830765, 2: 0.01889295130968094, 3: 0.015727277845144272, 4: 0.014807759784162045, 5: 0.013055448420345783, 6: 0.009929313324391842, 7: 0.009493204765021801, 8: 0.009047504514455795, 9: 0.008763314224779606, 10: 0.008395347744226456, 11: 0.007972066290676594, 12: 0.007687950972467661, 13: 0.007307332940399647, 14: 0.0070481086149811745, 15: 0.006770296487957239, 16: 0.0064987498335540295, 17: 0.006088548339903355, 18: 0.005601231474429369, 19: 0.00522360485047102, 20: 0.004635558929294348, 21: 0.004158490803092718, 22: 0.003993184771388769, 23: 0.0037280553951859474, 24: 0.0034076629672199488, 25: 0.003405185416340828, 26: 0.0032237910199910402, 27: 0.003177712205797434, 28: 0.003129011020064354, 29: 0.003115647006779909, 30: 0.0031041966285556555, 31: 0.0029882953967899084, 32: 0.00298613915219903, 33: 0.002952835988253355, 34: 0.002946380525827408, 35: 0.0029240185394883156, 36: 0.002875064965337515, 37: 0.0028642830438911915, 39: 0.002845409559085965, 40: 0.002819918328896165, 41: 0.002789083169773221, 44: 0.0027504467871040106, 47: 0.002743365243077278, 49: 0.002739810151979327, 52: 0.002695975126698613, 53: 0.0026743088383227587, 58: 0.0026608100160956383, 60: 0.002647414105013013, 61: 0.0026225652545690536, 68: 0.002614340279251337, 69: 0.0025987999979406595, 70: 0.002596708480268717, 71: 0.0025913631543517113, 72: 0.0025875321589410305, 73: 0.002572661032900214, 74: 0.0025336467660963535, 80: 0.0024994867853820324, 83: 0.0024994411505758762, 89: 0.002472454449161887, 100: 0.0024512517265975475, 101: 0.0024294471368193626, 109: 0.0024293619208037853, 116: 0.0024272180162370205, 118: 0.002419991185888648, 119: 0.002415239345282316, 123: 0.0024079775903373957, 124: 0.0023982326965779066, 134: 0.002392278518527746, 139: 0.002383048878982663, 144: 0.0023527909070253372, 178: 0.0023484763223677874, 181: 0.00233577867038548, 189: 0.002327487338334322, 226: 0.0023242253810167313, 243: 0.0023215501569211483, 270: 0.0023117593955248594, 288: 0.002311414573341608}

dict2 = {0: 0.063409723341465, 1: 0.011374265886843204, 2: 0.009728481061756611,
         3: 0.007864960469305515, 4: 0.0064465017057955265, 5: 0.004608689341694117,
         6: 0.004046186339110136, 7: 0.0036738617345690727, 9: 0.0035895933397114277,
         10: 0.0035162712447345257, 11: 0.0033300353679805994, 12: 0.003279652213677764,
         14: 0.0031770924106240273, 15: 0.0031643668189644814, 16: 0.0031448297668248415,
         17: 0.0030931434594094753, 18: 0.0030779039952903986, 19: 0.0029272669926285744,
         21: 0.0028385657351464033, 24: 0.0027062713634222746, 26: 0.0026771435514092445,
         27: 0.0026057392824441195, 31: 0.002533196471631527, 33: 0.00250671966932714,
         34: 0.0024750211741775274, 37: 0.002395572140812874, 40: 0.0023734557908028364,
         44: 0.0023456139024347067, 48: 0.0022874961141496897, 51: 0.002271551638841629,
         57: 0.0022397972643375397, 58: 0.002204832388088107, 59: 0.0021973142866045237,
         64: 0.00219659018330276, 68: 0.0021849970798939466, 69: 0.002151371445506811,
         74: 0.0021509842481464148, 76: 0.002133426256477833, 88: 0.002132283989340067,
         89: 0.002130963373929262, 90: 0.0021104805637151003, 98: 0.0020979789551347494,
         114: 0.0020936729852110147}

dict3 = {0: 0.01586034707725048, 1: 0.008797521702945232, 2: 0.006042883265763521,
         3: 0.005069734062999487, 4: 0.004588531330227852, 5: 0.004305392969399691,
         6: 0.004131849855184555, 7: 0.0039055661763995886, 8: 0.0038147231098264456,
         9: 0.0037436874117702246, 10: 0.003657786874100566, 12: 0.0034981751814484596,
         13: 0.003448360599577427, 14: 0.0034319746773689985, 16: 0.0033620113972574472,
         17: 0.003298863535746932, 18: 0.0032876229379326105, 19: 0.003284368896856904,
         20: 0.0032022709492594004, 23: 0.0031671079341322184, 25: 0.0031523616053164005,
         31: 0.0031249045860022306}



# 绘制折线图
plt.figure(figsize=(10, 6))
plt.plot(list(dict1.keys()), list(dict1.values()), marker='o', label='Transformer')
plt.plot(list(dict2.keys()), list(dict2.values()), marker='x', label='Transformer-MoE')
plt.plot(list(dict3.keys()), list(dict3.values()), marker='v', label='Mamba')

plt.xlabel('epoch')
plt.ylabel('MSE')
plt.title('Sequence model only')
plt.legend()
plt.grid(True)
plt.show()



"""
95: 0.00225468329153955
MSE_ave:0.0021679805000784148
MAE_ave:0.0366822914051058
R2:0.9514718209065282

-----------------
 90: 0.0022593755275011063, 96: 0.002230705926194787
MSE_ave:0.002205763814012913
MAE_ave:0.03698886460168051
R2:0.9506260773461358

------------
vae:
108: 0.0022907366510480642, 130: 0.0022898800671100616
MSE_ave:0.0022612227687212683
MAE_ave:0.03735663001727571
R2:0.9493846814863737
"""